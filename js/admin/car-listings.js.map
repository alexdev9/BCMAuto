{"version":3,"file":"car-listings.js","sourceRoot":"","sources":["../../../src/admin/car-listings.ts"],"names":[],"mappings":"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","sourcesContent":["import { Car } from '../types';\r\nimport { api } from '../mock-api';\r\nimport { formatPrice } from '../utils';\r\n\r\nexport function setupCarListings() {\r\n    const carListings = document.getElementById('carListings');\r\n    const searchInput = document.getElementById('adminSearchInput') as HTMLInputElement;\r\n    if (!carListings) return;\r\n\r\n    // State management\r\n    let currentPage = 1;\r\n    let searchTerm = '';\r\n\r\n    async function renderCarListings() {\r\n        if (!carListings) return;\r\n        \r\n        try {\r\n            const response = await api.getCars({\r\n                page: currentPage,\r\n                limit: 10, // Show more items per page in admin view\r\n                search: searchTerm\r\n            });\r\n\r\n            // Update table content\r\n            carListings.innerHTML = response.data.map((car: Car) => `\r\n                <tr>\r\n                    <td class=\"px-6 py-4\">\r\n                        <div class=\"flex items-center\">\r\n                            <img class=\"h-10 w-10 rounded-full object-cover\" \r\n                                 src=\"${car.images[0]}\" \r\n                                 alt=\"${car.make} ${car.model}\">\r\n                            <div class=\"ml-4\">\r\n                                <div class=\"text-sm font-medium text-gray-900\">\r\n                                    ${car.year} ${car.make} ${car.model}\r\n                                </div>\r\n                                <div class=\"text-sm text-gray-500\">\r\n                                    ${car.mileage.toLocaleString()} km\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </td>\r\n                    <td class=\"px-6 py-4 text-sm text-gray-500\">\r\n                        ${formatPrice(car.price)}\r\n                    </td>\r\n                    <td class=\"px-6 py-4 text-sm\">\r\n                        <button onclick=\"deleteCar('${car.id}')\" \r\n                                class=\"text-red-600 hover:text-red-900\">\r\n                            <i class=\"fas fa-trash\"></i> Delete\r\n                        </button>\r\n                    </td>\r\n                </tr>\r\n            `).join('');\r\n\r\n            // Update pagination controls\r\n            const paginationContainer = document.getElementById('adminPagination');\r\n            if (paginationContainer) {\r\n                paginationContainer.innerHTML = generatePaginationControls(response.page, response.totalPages);\r\n            }\r\n\r\n            // Show no results message if needed\r\n            if (response.data.length === 0) {\r\n                carListings.innerHTML = `\r\n                    <tr>\r\n                        <td colspan=\"3\" class=\"px-6 py-4 text-center text-gray-500\">\r\n                            No cars found${searchTerm ? ` matching \"${searchTerm}\"` : ''}.\r\n                        </td>\r\n                    </tr>\r\n                `;\r\n            }\r\n        } catch (error) {\r\n            console.error('Error loading cars:', error);\r\n            carListings.innerHTML = `\r\n                <tr>\r\n                    <td colspan=\"3\" class=\"px-6 py-4 text-center text-red-500\">\r\n                        Error loading cars. Please try again later.\r\n                    </td>\r\n                </tr>\r\n            `;\r\n        }\r\n    }\r\n\r\n    // Generate pagination controls HTML\r\n    function generatePaginationControls(currentPage: number, totalPages: number) {\r\n        const pages = [];\r\n        for (let i = 1; i <= totalPages; i++) {\r\n            pages.push(`\r\n                <button \r\n                    onclick=\"changeAdminPage(${i})\" \r\n                    class=\"px-3 py-1 rounded ${currentPage === i ? 'bg-blue-600 text-white' : 'bg-white text-gray-700 hover:bg-gray-100'}\"\r\n                >\r\n                    ${i}\r\n                </button>\r\n            `);\r\n        }\r\n        return pages.join('');\r\n    }\r\n\r\n    // Setup search handler\r\n    if (searchInput) {\r\n        let debounceTimeout: number;\r\n        searchInput.addEventListener('input', (e) => {\r\n            const target = e.target as HTMLInputElement;\r\n            clearTimeout(debounceTimeout);\r\n            debounceTimeout = window.setTimeout(() => {\r\n                searchTerm = target.value;\r\n                currentPage = 1; // Reset to first page on new search\r\n                renderCarListings();\r\n            }, 300);\r\n        });\r\n    }\r\n\r\n    // Delete car functionality\r\n    (window as any).deleteCar = async (carId: string) => {\r\n        if (confirm('Are you sure you want to delete this car?')) {\r\n            await api.deleteCar(carId);\r\n            renderCarListings();\r\n        }\r\n    };\r\n\r\n    // Expose pagination function to window\r\n    (window as any).changeAdminPage = (page: number) => {\r\n        currentPage = page;\r\n        renderCarListings();\r\n    };\r\n\r\n    return {\r\n        renderCarListings\r\n    };\r\n}"]}